#
# Define basic display information
#
name     : Assemble Transcripts using StringTie - v2.1.5

tooltip  : |
    Assemble the transcripts from RNA-seq read alignments using StringTie.
screenshots :
    []

icon: stringtie-yellow.png

#
# Define the set of other narrative methods that should be suggested to the user.
#
method-suggestions :
    related :
        []
    next :
        [identify_differential_expression_using_cuffdiff,identify_differential_expression_using_ballgown, identify_differential_expression_using_deseq2]

#
# Configure the display and description of the parameters
#
parameters :
  alignment_object_ref :
    ui-name : |
        ReadsAlignment(Set)
    short-hint : |
        Select the ReadsAlignment or ReadsAlignmentSet created by aligners such as Bowtie2, TopHat2, or HISAT2.
  stringtie_genome_name :
    ui-name : |
        StringTie Genome Name
    short-hint : |
        Provide a name for the Genome generated by StringTie.
  transcript_label :
    ui-name : |
      Default Transcript Label
    short-hint : |
      The prefix for the transcripts that cannot be linked to the original Genome used for reads alignment.
  expression_suffix :
    ui-name : |
        Expression Name Suffix
    short-hint : |
        Provide a suffix for the expression output object names.
  expression_set_suffix :
    ui-name : |
        ExpressionSet Name Suffix
    short-hint : |
        Provide a suffix for the ExpressionSet output object name.
  min_isoform_abundance :
    ui-name : |
      Minimum Isoform Abundance
    short-hint : |
      Set the minimum isoform abundance of the predicted transcripts as a fraction of the most abundant transcript assembled at a given locus. Lower abundance transcripts are often artifacts of incompletely spliced precursors of processed transcripts. Default is 0.1.
  junction_base :
    ui-name : |
      Filter Junctions
    short-hint : |
      Junctions that don't have spliced reads that align across them with at least this amount of bases on both sides are filtered out. Default is 10.
  min_length :
    ui-name : |
      Minimum Length
    short-hint : |
      Select the minimum length for predicted transcripts. Default is 200.
  junction_coverage :
    ui-name : |
      Minimum Spliced Reads
    short-hint : |
      Select the minimum spliced reads to align across a junction. Default is 1.
  min_read_coverage :
    ui-name : |
      Minimum Read Coverage
    short-hint : |
      Select the minimum read coverage allowed for predicted transcripts. Default is 2.5.
  min_locus_gap_sep_value :
    ui-name : |
      Minimum Locus Gap
    short-hint : |
      Select the minimum locus gap separation value. Default is 50.

parameter-groups :
  novel_isoforms :
    ui-name : |
        Make Novel Transcripts
    short-hint : |
        Output transcript expression matrices with novel isoforms.

description : |
    <p>This App assembles transcripts for a given sample or a sample set using StringTie and generates an Expression object for each individual sample and an ExpressionSet object for the sample set. The user can view the relative abundances of the assembled transcripts in a histogram that is also generated by this App.</p>

    <p>StringTie is a successor of Cufflinks that is faster and provides a more accurate reconstruction of genes and expression level. It accepts aligned RNA-seq reads from HISAT2, TopHat2 or Bowtie2 and assembles the alignments into a parsimonious set of transcripts. It then estimates the relative abundances of these transcripts based on how many reads support each one, taking into account biases in library preparation protocols.</p>

    <p>The StringTie output object contains GTF (transcripts.gtf) and FPKM (genes.fpkm_tracking) files. The GTF file contains annotated transcripts assembled by StringTie whereas the FPKM file provides the normalized ExpressionMatrix objects (abundance of each transcript expressed in fragments per kilobase of exon per million fragments mapped (FPKM) and transcripts per kilobase million (TPM)). The output RNASeqExpression objects can be rendered in the Narrative in tabular and histogram formats to visualize the abundance of normalized gene expression value in both log2(FPKM+1) and log2(TPM+1).</p>

    <p>The StringTie output object can be used to identify differential expression either using DESeq2, Cuffdiff, or Ballgown.</p>

    <p><strong>NOTE:</strong> This App is one of the steps in the <a href= "https://docs.kbase.us/workflows/rnaseq"> Transcriptomics and Expression Analysis Workflow</a> in KBase.</p>

    <p><strong>Team members who developed & deployed algorithm in KBase:</strong> Tianhao Gu, Christopher Henry, Shane Canon, Stephen Chan, Jason Baumohl, Sean McCorkle, Sunita Kumari, Shinjae Yoo, Priya Ranjan, and Vivek Kumar. For questions, please <a href="http://kbase.us/contact-us/">contact us</a>.</p>

publications :
    -
        display-text: |
            Frazee AC, Pertea G, Jaffe AE, Langmead B, Salzberg SL, Leek JT. Ballgown bridges the gap between transcriptome assembly and expression analysis. Nat Biotechnol. 2015;33: 243–246. doi:10.1038/nbt.3172
        link: https://www.nature.com/articles/nbt.3172

    -
        display text: |
            Kim D, Langmead B, Salzberg SL. HISAT: a fast spliced aligner with low memory requirements. Nature Methods. 2015;12: 357–360. doi:10.1038/nmeth.3317
        link: https://www.nature.com/articles/nmeth.3317

    -
        display-text: |
            Kim D, Pertea G, Trapnell C, Pimentel H, Kelley R, Salzberg SL. TopHat2: accurate alignment of transcriptomes in the presence of insertions, deletions and gene fusions. Genome Biology. 2013;14: R36. doi:10.1186/gb-2013-14-4-r36
        link: https://genomebiology.biomedcentral.com/articles/10.1186/gb-2013-14-4-r36

    -
        display-text: |
            Pertea M, Pertea GM, Antonescu CM, Chang T-C, Mendell JT, Salzberg SL. StringTie enables improved reconstruction of a transcriptome from RNA-seq reads. Nature Biotechnology. 2015;33: 290–295. doi:10.1038/nbt.3122
        link: https://www.nature.com/articles/nbt.3122

    -
        display-text: |
            Trapnell C, Pachter L, Salzberg SL. TopHat: discovering splice junctions with RNA-Seq. Bioinformatics. 2009;25: 1105–1111. doi:10.1093/bioinformatics/btp120
        link: https://academic.oup.com/bioinformatics/article/25/9/1105/203994

    -
        display-text: |
            Trapnell C, Roberts A, Goff L, Pertea G, Kim D, Kelley DR, et al. Differential gene and transcript expression analysis of RNA-seq experiments with TopHat and Cufflinks. Nat Protoc. 2012;7: 562–578. doi:10.1038/nprot.2012.016
        link: https://www.nature.com/articles/nprot.2012.016
